# ğŸ§  4-Layer Memory Hierarchy Simulation  
*(L3: 2-Way Set Associative Cache)*

---

## 1. í”„ë¡œì íŠ¸ ê°œìš”

ë³¸ í”„ë¡œì íŠ¸ëŠ” **ë°°ì—´ë§Œ ì‚¬ìš©í•˜ì—¬ 4ê³„ì¸µ ë©”ëª¨ë¦¬ ê³„ì¸µ êµ¬ì¡°ë¥¼ ì§ì ‘ ì„¤ê³„Â·êµ¬í˜„**í•˜ê³ ,  
ì‹¤ì„¸ê³„ ë°ì´í„° ì ‘ê·¼ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œ **ìºì‹œ hit ratioë¥¼ ë¶„ì„**í•˜ëŠ” ê²ƒì´ ëª©í‘œì´ë‹¤.

íŠ¹íˆ **L3 ê³„ì¸µì— 2-way set associative cache(E=2)**ë¥¼ ì ìš©í•˜ì—¬  
direct-mapped ìºì‹œì™€ì˜ ì°¨ì´ë¥¼ ì‹¤ì œ ì˜ˆì‹œë¥¼ í†µí•´ ê²€ì¦í•œë‹¤.

---

## 2. í”„ë¡œì íŠ¸ ëª©í‘œ

- ë°°ì—´ë§Œ ì‚¬ìš©í•œ 4ê³„ì¸µ ë©”ëª¨ë¦¬ ê³„ì¸µ êµ¬í˜„
- L3 ê³„ì¸µì— 2-way set associative ìºì‹œ ì ìš©
- 4096ê°œ ì´ˆê³¼ ì‹¤ì„¸ê³„ ë°ì´í„° ì‚¬ìš©
- ìºì‹œ hit / miss ì •í™•í•œ ê³„ì‚°
- ì‹¤ì œ ë°ì´í„° ì ‘ê·¼ íŒ¨í„´ ê¸°ë°˜ hit ratio ë¶„ì„
- ì½”ë“œ + ë³´ê³ ì„œ(report.pdf) ì œì¶œ

---

## 3. ë©”ëª¨ë¦¬ ê³„ì¸µ êµ¬ì¡° ì„¤ê³„

| ê³„ì¸µ | í¬ê¸° (elements) | ë§¤í•‘ ë°©ì‹ |
|-----|-----------------|-----------|
| L1  | 1               | Direct-mapped |
| L2  | 16              | Direct-mapped |
| L3  | 256             | **2-Way Set Associative (LRU)** |
| L4  | 4096            | Direct-mapped |

> ê³„ì¸µë³„ í¬ê¸°ëŠ” ë°ì´í„° íŠ¹ì„±ì— ë”°ë¼ ì¼ë¶€ ì¡°ì • ê°€ëŠ¥í•˜ë‚˜,  
> ì „ì²´ êµ¬ì¡°ëŠ” ë°˜ë“œì‹œ 4ê³„ì¸µì„ ìœ ì§€í•œë‹¤.

---

## 4. ì‹¤ì„¸ê³„ ë°ì´í„° ì‹œë‚˜ë¦¬ì˜¤

### ë°ì´í„° ì„¤ëª…
- ì‹¤ì„¸ê³„ ì ‘ê·¼ íŒ¨í„´ì„ ëª¨ì‚¬í•œ **ì •ìˆ˜ ì£¼ì†Œ ë°°ì—´**
- ë°ì´í„° í¬ê¸°: **ìµœì†Œ 4096 ì´ˆê³¼ (ê¶Œì¥ 20,000 ì´ìƒ)**
- ì˜ˆì‹œ ì‹œë‚˜ë¦¬ì˜¤:
  - ì›¹ í˜ì´ì§€ ID ë°˜ë³µ ì¡°íšŒ
  - ë‰´ìŠ¤ ê¸°ì‚¬ ID ì ‘ê·¼
  - ì‚¬ìš©ì í–‰ë™ ë¡œê·¸ ê¸°ë°˜ ì ‘ê·¼ íŒ¨í„´

### ì ‘ê·¼ íŠ¹ì§•
- íŠ¹ì • ì£¼ì†Œ ë°˜ë³µ ì ‘ê·¼ â†’ **Temporal Locality**
- ì¸ì ‘ ì£¼ì†Œ ì ‘ê·¼ â†’ **Spatial Locality**

---

## ğŸ§© êµ¬í˜„ êµ¬ì¡° (í´ë˜ìŠ¤ ì „ê°œë„ + ë‹´ë‹¹ì ë§¤í•‘)

### 1) í´ë˜ìŠ¤ ì „ê°œë„ (Architecture)
Main
â”œâ”€ TraceLoader            // access trace ë¡œë”©/ìƒì„±
â””â”€ MemorySystem           // ì „ì²´ ê³„ì¸µ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜(íë¦„ ì œì–´)
â”œâ”€ L1Cache             // L1 direct-mapped (1)
â”œâ”€ L2Cache             // L2 direct-mapped (16)
â”œâ”€ L3Cache2Way         // L3 2-way set associative (256, LRU)
â”œâ”€ L4Cache             // L4 direct-mapped (4096)
â””â”€ Stats               // hit/miss ì¹´ìš´í„°, ratio ê³„ì‚°/ì¶œë ¥

> ì›ì¹™: ê° ìºì‹œ ê³„ì¸µì€ **ë…ë¦½ í´ë˜ìŠ¤**, ë‚´ë¶€ ìë£Œêµ¬ì¡°ëŠ” **ë°°ì—´ë§Œ ì‚¬ìš©**  
> MemorySystemì€ â€œL1â†’L2â†’L3â†’L4â€ ì ‘ê·¼ íë¦„ë§Œ ì±…ì„ì§

---

### 2) í´ë˜ìŠ¤ë³„ ì—­í•  ìš”ì•½ (í•œ ì¤„ ì •ì˜)

- **Main**: í”„ë¡œê·¸ë¨ ì‹œì‘ì , ì…ë ¥(trace) ë°›ì•„ì„œ ì‹¤í–‰/ê²°ê³¼ ì¶œë ¥ íŠ¸ë¦¬ê±°  
- **TraceLoader**: ì‹¤ì„¸ê³„ ì‹œë‚˜ë¦¬ì˜¤ ê¸°ë°˜ accessTrace(int[]) ìƒì„± ë˜ëŠ” íŒŒì¼ ë¡œë”©  
- **MemorySystem**: ê³„ì¸µ ì ‘ê·¼ íë¦„ ì œì–´(ìƒìœ„ hitì´ë©´ í•˜ìœ„ ì ‘ê·¼ ì¤‘ë‹¨)  
- **L1Cache**: direct-mapped 1ë¼ì¸ ìºì‹œ (valid/tag/data + hit/miss)  
- **L2Cache**: direct-mapped 16ë¼ì¸ ìºì‹œ (valid/tag/data + hit/miss)  
- **L3Cache2Way**: **2-way set associative + LRU** (valid[set][2], tag[set][2], lru[set])  
- **L4Cache**: direct-mapped 4096ë¼ì¸ (ìµœí•˜ìœ„ ê³„ì¸µ ì €ì¥ì†Œ ì—­í• )  
- **Stats**: ê³„ì¸µë³„/ì „ì²´ hit ratio ê³„ì‚°, í‘œ í˜•íƒœ ì¶œë ¥

---

### 3) ë‹´ë‹¹ì ë°°ì • (ëˆ„ê°€ ì–´ë–¤ í´ë˜ìŠ¤ ë§¡ëŠ”ì§€)

#### ğŸ‘¤ ì—­í•  A (L1/L2 + ì„¤ê³„ íŒŒíŠ¸)
- `L1Cache`
- `L2Cache`
- (ì„ íƒ) `MemorySystem`ì˜ ê¸°ë³¸ íë¦„ ì„¤ê³„ì— ì°¸ì—¬(ì ‘ê·¼ ê·œì¹™ í•©ì˜)

#### ğŸ‘¤ ì—­í•  B (L3 2-way + LRU í•µì‹¬)
- `L3Cache2Way`
- (í•„ìˆ˜) eviction ê²€ì¦ìš© í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤/ë¡œê·¸ í¬ë§· ê°™ì´ ì •ì˜

#### ğŸ‘¤ ì—­í•  C (ë°ì´í„° + L4 + ì‹¤í—˜ ê²°ê³¼)
- `TraceLoader`
- `L4Cache`
- `Stats`
- `Main` (ìµœì¢… ì‹¤í–‰/í†µí•© ë‹´ë‹¹)

---

### 4) í†µí•© ì‹œ â€œê²¹ì¹˜ì§€ ì•Šê²Œâ€ í•©ì˜í•  ì¸í„°í˜ì´ìŠ¤ (í•„ìˆ˜)

ê° ìºì‹œ ê³„ì¸µ ê³µí†µ ë©”ì„œë“œ:
```java
boolean access(int address);   // hitì´ë©´ true, missì´ë©´ false

if (L1.hit) return;
else if (L2.hit) return;
else if (L3.hit) return;
else L4.load;
